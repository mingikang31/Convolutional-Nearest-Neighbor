Traceback (most recent call last):
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 153, in <module>
    main(args)
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 138, in main
    train_eval_results = Train_Eval(args, 
                         ^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/train_eval.py", line 92, in Train_Eval
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 187, in forward
    x = self.layer4(x)
        ^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 106, in forward
    out = self.bn1(out)
          ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/instancenorm.py", line 124, in forward
    return self._apply_instance_norm(input)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/instancenorm.py", line 47, in _apply_instance_norm
    return F.instance_norm(
           ^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/functional.py", line 2865, in instance_norm
    _verify_spatial_size(input.size())
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/functional.py", line 2831, in _verify_spatial_size
    raise ValueError(
ValueError: Expected more than 1 spatial element when training, got input size torch.Size([64, 512, 1, 1])
Traceback (most recent call last):
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 153, in <module>
    main(args)
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 138, in main
    train_eval_results = Train_Eval(args, 
                         ^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/train_eval.py", line 92, in Train_Eval
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 185, in forward
    x = self.layer2(x)
        ^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 115, in forward
    out += identity
RuntimeError: The size of tensor a (8) must match the size of tensor b (4) at non-singleton dimension 3
Traceback (most recent call last):
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 153, in <module>
    main(args)
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 138, in main
    train_eval_results = Train_Eval(args, 
                         ^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/train_eval.py", line 92, in Train_Eval
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 185, in forward
    x = self.layer2(x)
        ^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 115, in forward
    out += identity
RuntimeError: The size of tensor a (8) must match the size of tensor b (4) at non-singleton dimension 3
Traceback (most recent call last):
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 153, in <module>
    main(args)
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 138, in main
    train_eval_results = Train_Eval(args, 
                         ^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/train_eval.py", line 92, in Train_Eval
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 185, in forward
    x = self.layer2(x)
        ^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 115, in forward
    out += identity
RuntimeError: The size of tensor a (8) must match the size of tensor b (4) at non-singleton dimension 3
Traceback (most recent call last):
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 153, in <module>
    main(args)
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 138, in main
    train_eval_results = Train_Eval(args, 
                         ^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/train_eval.py", line 92, in Train_Eval
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 185, in forward
    x = self.layer2(x)
        ^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 115, in forward
    out += identity
RuntimeError: The size of tensor a (8) must match the size of tensor b (4) at non-singleton dimension 3
Traceback (most recent call last):
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 153, in <module>
    main(args)
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 138, in main
    train_eval_results = Train_Eval(args, 
                         ^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/train_eval.py", line 92, in Train_Eval
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 185, in forward
    x = self.layer2(x)
        ^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 115, in forward
    out += identity
RuntimeError: The size of tensor a (8) must match the size of tensor b (4) at non-singleton dimension 3
Traceback (most recent call last):
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 153, in <module>
    main(args)
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 138, in main
    train_eval_results = Train_Eval(args, 
                         ^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/train_eval.py", line 92, in Train_Eval
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 185, in forward
    x = self.layer2(x)
        ^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 115, in forward
    out += identity
RuntimeError: The size of tensor a (8) must match the size of tensor b (4) at non-singleton dimension 3
Traceback (most recent call last):
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 153, in <module>
    main(args)
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 138, in main
    train_eval_results = Train_Eval(args, 
                         ^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/train_eval.py", line 92, in Train_Eval
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 185, in forward
    x = self.layer2(x)
        ^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 115, in forward
    out += identity
RuntimeError: The size of tensor a (8) must match the size of tensor b (4) at non-singleton dimension 3
Traceback (most recent call last):
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 153, in <module>
    main(args)
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/resnet_main.py", line 138, in main
    train_eval_results = Train_Eval(args, 
                         ^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/train_eval.py", line 92, in Train_Eval
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 185, in forward
    x = self.layer2(x)
        ^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/miniconda3/envs/mingi/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/research/j.farias/mkang2/Convolutional-Nearest-Neighbor/models/resnet.py", line 115, in forward
    out += identity
RuntimeError: The size of tensor a (8) must match the size of tensor b (4) at non-singleton dimension 3
