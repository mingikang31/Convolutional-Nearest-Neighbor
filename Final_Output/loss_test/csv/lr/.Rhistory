c.i.90 = quantile(post.sample, c(alpha.post/2, 1-alpha.post/2))
cat("credible interval 90: ", c.i.90, "\n")
prob.0.5 <- pbeta(value, alpha.prime, beta.prime, lower.tail=FALSE)
cat("Probability that theta > 0.5: ", prob.0.5, "\n")
prob.3.or.fewer.next10 <- 0
cat("Probability that Jill will have 3 or fewer successful runs in the next 10 rodeos: ", prob.3.or.fewer.next10)
alpha.prime = 5.5
beta.prime = 14.5
eps <- 0.0001
x <- seq(eps,1-eps,eps)
posterior <- dbeta(x, alpha.prime, beta.prime)
# 1. posterior mean
M = 1e6
post.sample = sample(x, M, replace=TRUE, prob=post)
post.mean = mean(post.sample)
# 2. Median, Mode
post.median = median(post.sample)
post.mode = mode(post.sample)
cat("mean: ", post.mean, "\n")
cat("median: ", post.median, "\n")
cat("mode: ", post.median, "\n")
# 3 + 4. 95 credible interval, 99 credible interval
alpha.post = 0.1
c.i.90 = quantile(post.sample, c(alpha.post/2, 1-alpha.post/2))
cat("credible interval 90: ", c.i.90, "\n")
prob.0.5 <- pbeta(value, alpha.prime, beta.prime, lower.tail=FALSE)
cat("Probability that theta > 0.5: ", prob.0.5, "\n")
# 3 or fewer successful runs in the next 10 rodeos
n.new = 10
alpha.post = 5.5
beta.post = 14.5
prob.3.or.fewer.next10 = pbbinom(3, size=n.new, alpha=alpha.post, beta=beta.post)
library(extraDistr)
install.packages("extraDistr")
library(extraDistr)
alpha.prime = 5.5
beta.prime = 14.5
eps <- 0.0001
x <- seq(eps,1-eps,eps)
posterior <- dbeta(x, alpha.prime, beta.prime)
# 1. posterior mean
M = 1e6
post.sample = sample(x, M, replace=TRUE, prob=post)
post.mean = mean(post.sample)
# 2. Median, Mode
post.median = median(post.sample)
post.mode = mode(post.sample)
cat("mean: ", post.mean, "\n")
cat("median: ", post.median, "\n")
cat("mode: ", post.median, "\n")
# 3 + 4. 95 credible interval, 99 credible interval
alpha.post = 0.1
c.i.90 = quantile(post.sample, c(alpha.post/2, 1-alpha.post/2))
cat("credible interval 90: ", c.i.90, "\n")
prob.0.5 <- pbeta(value, alpha.prime, beta.prime, lower.tail=FALSE)
cat("Probability that theta > 0.5: ", prob.0.5, "\n")
# 3 or fewer successful runs in the next 10 rodeos
n.new = 10
alpha.post = 5.5
beta.post = 14.5
prob.3.or.fewer.next10 = pbbinom(3, size=n.new, alpha=alpha.post, beta=beta.post)
cat("Probability that Jill will have 3 or fewer successful runs in the next 10 rodeos: ", prob.3.or.fewer.next10)
x = seq(0.001, 200, by=0.001)
y1 = dgamma(x, shape=1, rate=1)
y2 = dgamma(x, shape=0.5, rate=0.5)
y3 = dgamma(x, shape=5, rate=0.5)
plot(x, y1, col='red')
points(x, y2, col='blue')
points(x, y3, col="green")
x = seq(0.001, 20, by=0.001)
y1 = dgamma(x, shape=1, rate=1)
y2 = dgamma(x, shape=0.5, rate=0.5)
y3 = dgamma(x, shape=5, rate=0.5)
plot(x, y1, col='red')
points(x, y2, col='blue')
points(x, y3, col="green")
x = seq(0.001, 20, by=0.001)
y1 = dgamma(x, shape=1, rate=1)
y2 = dgamma(x, shape=0.5, rate=0.5)
y3 = dgamma(x, shape=5, rate=0.5)
plot(x, y1, col='red', lwd=1)
points(x, y2, col='blue', lwd=1)
points(x, y3, col="green",  lwd=1)
x = seq(0.001, 20, by=0.001)
y1 = dgamma(x, shape=1, rate=1)
y2 = dgamma(x, shape=0.5, rate=0.5)
y3 = dgamma(x, shape=5, rate=0.5)
plot(x, y1, col='red', lwd=0.5)
points(x, y2, col='blue', lwd=0.5)
points(x, y3, col="green",  lwd=0.5)
x = seq(0.001, 20, by=0.001)
y1 = dgamma(x, shape=1, rate=1)
y2 = dgamma(x, shape=0.5, rate=0.5)
y3 = dgamma(x, shape=5, rate=0.5)
plot(x, y1, col='red', lwd=1)
lines(x, y2, col='blue', lwd=1)
lines(x, y3, col="green",  lwd=1)
x = seq(0.001, 20, by=0.001)
y1 = dgamma(x, shape=1, rate=1)
y2 = dgamma(x, shape=0.5, rate=0.5)
y3 = dgamma(x, shape=5, rate=0.5)
plot(x, y1, col='red', lwd=1, type="l")
lines(x, y2, col='blue', lwd=1)
lines(x, y3, col="green",  lwd=1)
x = seq(0.001, 20, by=0.001)
y1 = dgamma(x, shape=1, rate=1)
y2 = dgamma(x, shape=0.5, rate=0.5)
y3 = dgamma(x, shape=5, rate=0.5)
plot(x, y1, col='red', lwd=2, type="l")
lines(x, y2, col='blue', lwd=2)
lines(x, y3, col="green",  lwd=2)
x = seq(0.001, 20, by=0.001)
y1 = dgamma(x, shape=1, rate=1)
y2 = dgamma(x, shape=0.5, rate=0.5)
y3 = dgamma(x, shape=5, rate=0.5)
plot(x, y1, col='red', lwd=2, type="l")
lines(x, y2, col='blue', lwd=2)
lines(x, y3, col="green",  lwd=2)
legend("topright",
legend = c("alpha=1, beta=1", "alpha=0.5, beta=0.5", "alpha=5, beta=0.5"),
col = c("red", "blue", "green"),
)
x = seq(0.001, 20, by=0.001)
y1 = dgamma(x, shape=1, rate=1)
y2 = dgamma(x, shape=0.5, rate=0.5)
y3 = dgamma(x, shape=5, rate=0.5)
plot(x, y1, col='red', lwd=2, type="l")
lines(x, y2, col='blue', lwd=2)
lines(x, y3, col="green",  lwd=2)
legend("topright",
legend = c("alpha=1, beta=1", "alpha=0.5, beta=0.5", "alpha=5, beta=0.5"),
col = c("red", "blue", "green"),
lty = 1,
lwd = 2
)
x = seq(0.001, 20, by=0.001)
y1 = dgamma(x, shape=1, rate=1)
y2 = dgamma(x, shape=0.5, rate=0.5)
y3 = dgamma(x, shape=5, rate=0.5)
plot(x, y1, col='red', lwd=2, type="l")
lines(x, y2, col='blue', lwd=2)
lines(x, y3, col="green",  lwd=2)
legend("topright",
legend = c("alpha=1, beta=1", "alpha=0.5, beta=0.5", "alpha=5, beta=0.5"),
col = c("red", "blue", "green"),
lty = 1,
lwd = 2
)
library(extraDistr)
alpha.prime = 5.5
beta.prime = 14.5
eps <- 0.0001
x <- seq(eps,1-eps,eps)
posterior <- dbeta(x, alpha.prime, beta.prime)
# 1. posterior mean
M = 1e6
post.sample = sample(x, M, replace=TRUE, prob=posterior)
post.mean = mean(post.sample)
# 2. Median, Mode
post.median = median(post.sample)
post.mode = mode(post.sample)
cat("mean: ", post.mean, "\n")
cat("median: ", post.median, "\n")
cat("mode: ", post.median, "\n")
# 3 + 4. 95 credible interval, 99 credible interval
alpha.post = 0.1
c.i.90 = quantile(post.sample, c(alpha.post/2, 1-alpha.post/2))
cat("credible interval 90: ", c.i.90, "\n")
prob.0.5 <- pbeta(value, alpha.prime, beta.prime, lower.tail=FALSE)
cat("Probability that theta > 0.5: ", prob.0.5, "\n")
# 3 or fewer successful runs in the next 10 rodeos
n.new = 10
alpha.post = 5.5
beta.post = 14.5
prob.3.or.fewer.next10 = pbbinom(3, size=n.new, alpha=alpha.post, beta=beta.post)
cat("Probability that Jill will have 3 or fewer successful runs in the next 10 rodeos: ", prob.3.or.fewer.next10)
alpha.prime = 75
beta.prime = 47
value = 2/3
probability.2.3 =  pbeta(value, alpha.prime, beta.prime, lower.tail=FALSE)
cat("P(posterior >= 2/3): ", probability.2.3)
library(extraDistr)
alpha.prime = 5.5
beta.prime = 14.5
eps <- 0.0001
x <- seq(eps,1-eps,eps)
posterior <- dbeta(x, alpha.prime, beta.prime)
# 1. posterior mean
post.mean = alpha.prime / (alpha.prime + beta.prime)
# 2. Median, Mode
post.median = qbeta(0.5, alpha.prime, beta.prime)
post.mode = (alpha.prime - 1) / (alpha.prime + beta.prime - 2)
cat("mean: ", post.mean, "\n")
cat("median: ", post.median, "\n")
cat("mode: ", post.median, "\n")
# 3 + 4. 95 credible interval, 99 credible interval
c.i.90 = qbet(c(0.05, 0.95), alpha.prime, beta.prime)
library(extraDistr)
alpha.prime = 5.5
beta.prime = 14.5
eps <- 0.0001
x <- seq(eps,1-eps,eps)
posterior <- dbeta(x, alpha.prime, beta.prime)
# 1. posterior mean
post.mean = alpha.prime / (alpha.prime + beta.prime)
# 2. Median, Mode
post.median = qbeta(0.5, alpha.prime, beta.prime)
post.mode = (alpha.prime - 1) / (alpha.prime + beta.prime - 2)
cat("mean: ", post.mean, "\n")
cat("median: ", post.median, "\n")
cat("mode: ", post.median, "\n")
# 3 + 4. 95 credible interval, 99 credible interval
c.i.90 = qbeta(c(0.05, 0.95), alpha.prime, beta.prime)
cat("credible interval 90: ", c.i.90, "\n")
prob.0.5 <- pbeta(0.5, alpha.prime, beta.prime, lower.tail=FALSE)
cat("Probability that theta > 0.5: ", prob.0.5, "\n")
# 3 or fewer successful runs in the next 10 rodeos
n.new = 10
alpha.post = 5.5
beta.post = 14.5
k_vals <- 0:n.new
pred_probs <- dbbinom(k_vals, size = n.new, alpha = alpha.prime, beta = beta.prime)
barplot(pred_probs, names.arg = k_vals, xlab = "Number of Successes in Next 10 Rodeos",
ylab = "Probability", main = "Posterior Predictive Distribution", col = "lightblue")
prob.3.or.fewer.next10 = pbbinom(3, size=n.new, alpha=alpha.post, beta=beta.post)
cat("Probability that Jill will have 3 or fewer successful runs in the next 10 rodeos: ", prob.3.or.fewer.next10)
library(extraDistr)
alpha.prime = 5.5
beta.prime = 14.5
eps <- 0.0001
x <- seq(eps,1-eps,eps)
posterior <- dbeta(x, alpha.prime, beta.prime)
# 1. posterior mean
post.mean = alpha.prime / (alpha.prime + beta.prime)
# 2. Median, Mode
post.median = qbeta(0.5, alpha.prime, beta.prime)
post.mode = (alpha.prime - 1) / (alpha.prime + beta.prime - 2)
cat("mean: ", post.mean, "\n")
cat("median: ", post.median, "\n")
cat("mode: ", post.median, "\n")
# 3 + 4. 95 credible interval, 99 credible interval
c.i.90 = qbeta(c(0.05, 0.95), alpha.prime, beta.prime)
cat("credible interval 90: ", c.i.90, "\n")
prob.0.5 <- pbeta(0.5, alpha.prime, beta.prime, lower.tail=FALSE)
cat("Probability that theta > 0.5: ", prob.0.5, "\n")
# 3 or fewer successful runs in the next 10 rodeos
n.new = 10
alpha.post = 5.5
beta.post = 14.5
k_vals <- 0:n.new
pred_probs <- dbbinom(k_vals, size = n.new, alpha = alpha.prime, beta = beta.prime)
hist(k_val, pred_probs)
library(extraDistr)
alpha.prime = 5.5
beta.prime = 14.5
eps <- 0.0001
x <- seq(eps,1-eps,eps)
posterior <- dbeta(x, alpha.prime, beta.prime)
# 1. posterior mean
post.mean = alpha.prime / (alpha.prime + beta.prime)
# 2. Median, Mode
post.median = qbeta(0.5, alpha.prime, beta.prime)
post.mode = (alpha.prime - 1) / (alpha.prime + beta.prime - 2)
cat("mean: ", post.mean, "\n")
cat("median: ", post.median, "\n")
cat("mode: ", post.median, "\n")
# 3 + 4. 95 credible interval, 99 credible interval
c.i.90 = qbeta(c(0.05, 0.95), alpha.prime, beta.prime)
cat("credible interval 90: ", c.i.90, "\n")
prob.0.5 <- pbeta(0.5, alpha.prime, beta.prime, lower.tail=FALSE)
cat("Probability that theta > 0.5: ", prob.0.5, "\n")
# 3 or fewer successful runs in the next 10 rodeos
n.new = 10
alpha.post = 5.5
beta.post = 14.5
k_vals <- 0:n.new
pred_probs <- dbbinom(k_vals, size = n.new, alpha = alpha.prime, beta = beta.prime)
barplot(pred_probs, names.arg = k_vals, xlab = "Number of Successes in Next 10 Rodeos",
ylab = "Probability", main = "Posterior Predictive Distribution", col = "lightblue")
prob.3.or.fewer.next10 = pbbinom(3, size=n.new, alpha=alpha.post, beta=beta.post)
cat("Probability that Jill will have 3 or fewer successful runs in the next 10 rodeos: ", prob.3.or.fewer.next10)
plot(x, y, col='blue')
N = 100
x = seq(0, 1, length.out=N)
y = sqrt(1-x^2)
plot(x, y, col='blue')
N = 100
x = seq(0, 1, length.out=N)
y = sqrt(1-x^2)
eps = x[2] - x[1]
plot(x, y, col='blue')
riemann.sum = sum(y) * eps
est.pi = riemann.sum * 4
cat("Estimated Pi with riemann sum: ", est.pi)
N = 100000
x = seq(0, 1, length.out=N)
y = sqrt(1-x^2)
eps = x[2] - x[1]
plot(x, y, col='blue')
riemann.sum = sum(y) * eps
est.pi = riemann.sum * 4
cat("Estimated Pi with riemann sum: ", est.pi)
riemann.sum = function(N=100, ){
riemann.sum = function(N=100, ){
riemann.sum = function(N=100){
x = seq(0, 1, length.out=N)
y = sqrt(1-x^2)
eps = x[2] - x[1]
riemann.sum = sum(y) * eps
est.pi = riemann.sum * 4
return (est.pi)
}
es = riemann.sum(10000)
print(es)
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
pis
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerics/riemann.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
lpost
lk
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
source("~/Desktop/Adv Stats/Class/numerical methods/target.R")
# 1. Loss's for different LRs
library(tidyverse)
library(zoo)  # For rollmean function
install.packages("zoo")
# 1. Loss's for different LRs
library(tidyverse)
library(zoo)  # For rollmean function
setwd("/Users/mingikang/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/csv/lr")
# Smoothing window size (adjust this for more/less smoothing)
SMOOTH_WINDOW <- 10  # Try values like 5, 10, 15, 20
datasets = c("CIFAR10", "CIFAR100")
lrs = c("1e-3", "1e-4", "1e-5", "5e-4", "5e-5")
for (dataset in datasets) {
for (lr in lrs){
path <- paste0("VGG11-", dataset, "_lr_", lr, ".csv")
print(path)
# Loss <-> Accuracy Top1
plot_title = paste0(dataset, " Loss for lr = ", lr)
save_path <- paste0("../../plots/VGG11-", dataset, "_lr_", lr, "_plot", ".png")
data <- read.csv(path)
# Reorder the df
df_long <- data %>%
pivot_longer(
cols = -epoch,
names_to = c("Model", "Type", ".value"),
names_sep = "_"
) %>%
# Apply moving average smoothing
group_by(Model, Type) %>%
mutate(
Loss_smooth = rollmean(Loss, k = SMOOTH_WINDOW, fill = NA, align = "right")
) %>%
ungroup()
# Create a single combined plot
combined_plot <- df_long %>%
# Use Loss_smooth instead of Loss
ggplot(aes(x = epoch, y = Loss_smooth, color = Model, linetype = Type)) +
geom_line(linewidth = 1.0) +
scale_linetype_manual(
name = "Loss Type",
values = c("Train" = "dotted", "Test" = "solid")
) +
# --- Labels and Titles ---
labs(
title = plot_title,
subtitle = "Comparison of Conv2d and Branching ConvNN",
x = "Epochs",
y = "Loss",
color = "Model"
) +
# --- Theme and Styling ---
theme_bw(base_size = 10) +
theme(
legend.position = "right",
plot.title = element_text(face = "bold", size = 23),
plot.subtitle = element_text(size = 18),
legend.title = element_text(face = "bold")
)
# Save the combined plot to a file
ggsave(
save_path,
plot = combined_plot,
width = 8,
height = 5,
units = "in",
dpi = 300,
bg = "white"
)
}
}
# 1. Loss's for different LRs
library(tidyverse)
library(zoo)  # For rollmean function
setwd("/Users/mingikang/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/csv/lr")
# Smoothing window size (adjust this for more/less smoothing)
SMOOTH_WINDOW <- 5  # Try values like 5, 10, 15, 20
datasets = c("CIFAR10", "CIFAR100")
lrs = c("1e-3", "1e-4", "1e-5", "5e-4", "5e-5")
for (dataset in datasets) {
for (lr in lrs){
path <- paste0("VGG11-", dataset, "_lr_", lr, ".csv")
print(path)
# Loss <-> Accuracy Top1
plot_title = paste0(dataset, " Loss for lr = ", lr)
save_path <- paste0("../../plots/Loss Plots/MA 5/VGG11-", dataset, "_lr_", lr, "_plot", ".png")
data <- read.csv(path)
# Reorder the df
df_long <- data %>%
pivot_longer(
cols = -epoch,
names_to = c("Model", "Type", ".value"),
names_sep = "_"
) %>%
# Apply moving average smoothing
group_by(Model, Type) %>%
mutate(
Loss_smooth = rollmean(Loss, k = SMOOTH_WINDOW, fill = NA, align = "right")
) %>%
ungroup()
# Create a single combined plot
combined_plot <- df_long %>%
# Use Loss_smooth instead of Loss
ggplot(aes(x = epoch, y = Loss_smooth, color = Model, linetype = Type)) +
geom_line(linewidth = 1.0) +
scale_linetype_manual(
name = "Loss Type",
values = c("Train" = "dotted", "Test" = "solid")
) +
# --- Labels and Titles ---
labs(
title = plot_title,
subtitle = "Comparison of Conv2d and Branching ConvNN",
x = "Epochs",
y = "Loss",
color = "Model"
) +
# --- Theme and Styling ---
theme_bw(base_size = 10) +
theme(
legend.position = "right",
plot.title = element_text(face = "bold", size = 23),
plot.subtitle = element_text(size = 18),
legend.title = element_text(face = "bold")
)
# Save the combined plot to a file
ggsave(
save_path,
plot = combined_plot,
width = 8,
height = 5,
units = "in",
dpi = 300,
bg = "white"
)
}
}
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
source("~/Developer/Convolutional-Nearest-Neighbor/Final_Output/loss_test/ma_plots.r")
